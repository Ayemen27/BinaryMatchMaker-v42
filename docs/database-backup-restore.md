# دليل النسخ الاحتياطي واستعادة قاعدة البيانات

هذا الدليل يشرح كيفية إنشاء نسخة احتياطية من قاعدة البيانات واستعادتها عند نقل المشروع إلى بيئة جديدة.

## النسخ الاحتياطي

لإنشاء نسخة احتياطية من قاعدة البيانات، قم بتنفيذ هذا الأمر:

```bash
node scripts/backup-database.js
```

هذا سيقوم بإنشاء ملفين:
1. ملف في مجلد `backups/` يحتوي على نسخة كاملة من قاعدة البيانات بما في ذلك البيانات
2. ملف `backups/schema.sql` يحتوي فقط على هيكل قاعدة البيانات (الجداول والعلاقات) بدون البيانات

## استعادة قاعدة البيانات

### استعادة الهيكل فقط

إذا كنت ترغب في إنشاء قاعدة بيانات جديدة بنفس الهيكل ولكن بدون البيانات:

```bash
node scripts/restore-database.js schema.sql
```

### استعادة نسخة كاملة

لاستعادة نسخة كاملة من قاعدة البيانات بما في ذلك البيانات:

```bash
node scripts/restore-database.js backup-2024-05-18T120000-000Z.sql
```

حيث `backup-2024-05-18T120000-000Z.sql` هو اسم ملف النسخة الاحتياطية الذي ترغب في استعادته.

## عند نقل المشروع إلى بيئة جديدة

1. قم بإنشاء نسخة احتياطية من قاعدة البيانات الحالية
2. انقل ملفات النسخة الاحتياطية من مجلد `backups/` إلى المشروع الجديد
3. في البيئة الجديدة، تأكد من إنشاء قاعدة بيانات وتحديث متغيرات البيئة
4. قم باستعادة قاعدة البيانات باستخدام سكربت الاستعادة

## ملاحظات مهمة

- تأكد من تحديث متغيرات البيئة الخاصة بقاعدة البيانات في البيئة الجديدة
- قد تحتاج إلى تثبيت `pg_dump` و `psql` في البيئة الجديدة إذا لم تكن متوفرة
- يتم تخزين جميع النسخ الاحتياطية في مجلد `backups/`
- يمكن أيضًا استخدام هذه السكربتات لنقل البيانات بين بيئات التطوير والإنتاج